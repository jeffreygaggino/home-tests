

/**
   Cover Video is a video-component that acts like a background-image
 **/
const CoverVideo = {
    name: 'cover-video',
    props: {
        screen_width: { required: true, type: Number },
        video_src: {required: true, type: Object},
    },
    data(){
        return{
            video: {
                video: '',
                img: ''
            }
        }
    },
    created(){
        // set video and poster depending on the screen size
        if(this.screen_width >= 768){
            this.video.video = this.video_src.desktop.src;
            this.video.img = this.video_src.desktop.poster;
        }
        else{
            this.video.video = this.video_src.mobile.src;
            this.video.img = this.video_src.mobile.poster;
        }
    },
    watch: {
        screen_width: function() {
            if(this.screen_width >= 768){
                this.video.video = this.video_src.desktop.src;
                this.video.img = this.video_src.desktop.poster;
            }
            else{
                this.video.video = this.video_src.mobile.src;
                this.video.img = this.video_src.mobile.poster;
            }
        }
    },
    mounted(){
        // // intersect observe the video to play
        // observe_show_video = new IntersectionObserver(entries => {
        //     entries.forEach(entry => {
        //         if (entry.intersectionRatio > 0) {
        //             document.querySelector("#product-video-prime").play();
        //         }
        //     });
        // });
        // observe_show_video.observe(document.querySelector("#product-video-prime"));
    },
    template: /*html*/
    `
        <div class="cover-video" >
                <video :poster="video.img" autoplay preload="none" playsinline muted loop>
                    <source :src="video.video" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
        </div>
    `
};

const HeaderNav = {
    name: 'header-nav',
    props: {
        screen_width: { required: true, type: Number },
    },
    data(){
        return{
            transparent_nav: true,
        }
    },
    created(){
        
    },
    watch: {
        screen_width: function() {
           
        }
    },
    mounted(){
        // // intersect observe the video to play
        // observe_show_video = new IntersectionObserver(entries => {
        //     entries.forEach(entry => {
        //         if (entry.intersectionRatio > 0) {
        //             document.querySelector("#product-video-prime").play();
        //         }
        //     });
        // });
        // observe_show_video.observe(document.querySelector("#product-video-prime"));
    },
    template: /*html*/
    `
    <div id="header-outside-container" :class="transparent_nav && 'transparent_nav'">
    <div id="header-container" v-if="screen_width < 991" class="mobile-nav" >
        <i class="icon-burger" >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 12H21" stroke="" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 6H21" stroke="" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 18H21" stroke="" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>  
        </i>
        <i class="logo-hismile" >
            <svg class="hismile-logo" width="91" height="24" viewBox="0 0 91 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.50743 0V10.7635C4.01695 10.0459 4.6957 9.46562 5.48329 9.07415C6.27088 8.68267 7.1429 8.49217 8.02177 8.51958C11.4317 8.51958 13.9326 10.9583 13.9326 14.2426V23.576H10.4248V15.2181C10.3903 14.3229 10.0108 13.476 9.36609 12.8549C8.72136 12.2338 7.86144 11.8868 6.96675 11.8868C6.07206 11.8868 5.21214 12.2338 4.56741 12.8549C3.92268 13.476 3.54324 14.3229 3.50872 15.2181V23.5751H0V0H3.50743Z" />
                <path d="M18.8034 2.04859C19.0998 2.0409 19.3947 2.09368 19.67 2.20373C19.9454 2.31377 20.1955 2.47878 20.4052 2.68869C20.6148 2.89861 20.7796 3.14904 20.8895 3.42476C20.9995 3.70047 21.0522 3.99569 21.0445 4.29246C21.0487 4.58679 20.9934 4.87892 20.8819 5.15127C20.7703 5.42362 20.6049 5.67054 20.3955 5.87714C20.1861 6.08375 19.9371 6.24577 19.6635 6.35345C19.3898 6.46112 19.0973 6.51221 18.8034 6.50365C18.5114 6.51135 18.2208 6.4594 17.9495 6.35099C17.6781 6.24258 17.4317 6.07996 17.2252 5.87306C17.0187 5.66616 16.8564 5.41931 16.7483 5.14756C16.6402 4.87582 16.5884 4.58487 16.5963 4.29246C16.585 3.99764 16.6342 3.70363 16.7406 3.42854C16.8471 3.15344 17.0087 2.90308 17.2155 2.69287C17.4222 2.48267 17.6698 2.31706 17.9429 2.20626C18.216 2.09545 18.5088 2.04179 18.8034 2.04859ZM20.5574 8.94236V23.5751H17.0499V8.94236H20.5574Z" />
                <path d="M22.8955 19.7054L26.1753 19.2176C26.433 20.2258 27.3781 20.9411 29.0658 20.9411C30.3648 20.9411 31.404 20.4533 31.404 19.5428C31.404 18.9251 30.9495 18.5023 29.7802 18.1122L26.7926 17.169C24.3242 16.3561 23.2851 15.1531 23.2851 13.0718C23.2851 9.85287 25.8196 8.51953 28.9361 8.51953C32.151 8.51953 34.1648 10.0804 34.5205 12.4542L31.2403 13.0069C31.0131 12.1613 30.169 11.5445 28.6749 11.5445C27.5705 11.5445 26.6289 11.9673 26.6289 12.8129C26.6289 13.3656 27.0185 13.6907 27.9279 14.0172L30.916 15.0253C33.6115 15.9681 34.7482 17.3015 34.7482 19.415C34.7482 22.569 32.1497 24 28.967 24C25.396 24 23.2851 22.3071 22.8955 19.7054Z" />
                <path d="M40.6597 8.94241V10.5033C41.142 9.87029 41.7671 9.36058 42.4838 9.01581C43.2006 8.67104 43.9886 8.50101 44.7836 8.51961C45.6917 8.50347 46.5895 8.71509 47.3951 9.13517C48.2006 9.55526 48.8885 10.1705 49.3959 10.9248C49.8952 10.155 50.5858 9.5284 51.4 9.10651C52.2142 8.68462 53.1239 8.48193 54.0399 8.51832C57.385 8.51832 59.8533 10.8594 59.8533 13.9489V23.5751H56.3781V14.9579C56.3829 14.5535 56.3074 14.1521 56.1562 13.777C56.0049 13.402 55.7808 13.0607 55.4969 12.773C55.2129 12.4853 54.8748 12.2569 54.502 12.101C54.1292 11.9451 53.7293 11.8649 53.3253 11.8649C52.9214 11.8649 52.5214 11.9451 52.1487 12.101C51.7759 12.2569 51.4378 12.4853 51.1538 12.773C50.8699 13.0607 50.6458 13.402 50.4945 13.777C50.3432 14.1521 50.2678 14.5535 50.2726 14.9579V23.5751H46.7652V14.9579C46.77 14.5535 46.6945 14.1521 46.5433 13.777C46.392 13.402 46.1679 13.0607 45.884 12.773C45.6 12.4853 45.2619 12.2569 44.8891 12.101C44.5164 11.9451 44.1164 11.8649 43.7124 11.8649C43.3085 11.8649 42.9085 11.9451 42.5358 12.101C42.163 12.2569 41.8249 12.4853 41.5409 12.773C41.257 13.0607 41.0329 13.402 40.8816 13.777C40.7303 14.1521 40.6549 14.5535 40.6597 14.9579V23.5751H37.1519V8.94241H40.6597Z" />
                <path d="M64.7248 2.04857C65.0211 2.04095 65.3159 2.09378 65.5913 2.20385C65.8666 2.31392 66.1167 2.47893 66.3263 2.68884C66.5359 2.89875 66.7006 3.14916 66.8105 3.42485C66.9204 3.70053 66.9731 3.99572 66.9654 4.29245C66.9697 4.58674 66.9143 4.87884 66.8028 5.15116C66.6913 5.42347 66.5259 5.67037 66.3166 5.87697C66.1072 6.08358 65.8582 6.24561 65.5847 6.35331C65.3111 6.461 65.0186 6.51214 64.7248 6.50364C64.4327 6.51146 64.1421 6.4596 63.8706 6.35124C63.5992 6.24287 63.3527 6.08027 63.1461 5.87335C62.9395 5.66643 62.7772 5.41953 62.6691 5.14773C62.561 4.87592 62.5093 4.58491 62.5172 4.29245C62.5059 3.99758 62.555 3.7035 62.6615 3.42835C62.7679 3.15319 62.9296 2.90279 63.1364 2.69256C63.3432 2.48234 63.5909 2.31674 63.864 2.20599C64.1372 2.09523 64.4301 2.04166 64.7248 2.04857ZM66.4783 8.94235V23.5751H62.9708V8.94235H66.4783Z" />
                <path d="M69.5962 0H73.1036V23.5751H69.5962V0Z" />
                <path d="M83.3659 8.51983C84.3797 8.50779 85.3855 8.70046 86.3232 9.08633C87.261 9.4722 88.1114 10.0434 88.8238 10.7657C89.5361 11.488 90.0958 12.3467 90.4693 13.2904C90.8428 14.2341 91.0225 15.2435 90.9976 16.2583C90.9976 16.6937 90.9651 17.1284 90.9005 17.559H79.3061C79.559 18.4978 80.1186 19.3248 80.8956 19.9082C81.6725 20.4916 82.6222 20.7977 83.5932 20.7779C84.2406 20.7809 84.8809 20.6429 85.4697 20.3733C86.0585 20.1038 86.5818 19.7093 87.0031 19.217L90.4134 20.2252C89.7091 21.3997 88.7074 22.367 87.5098 23.0294C86.3122 23.6917 84.9611 24.0256 83.5932 23.9973C79.0788 23.9973 75.6689 20.6807 75.6689 16.2583C75.646 15.2385 75.8293 14.2246 76.2076 13.2775C76.5859 12.3304 77.1515 11.4696 77.8704 10.7468C78.5893 10.024 79.4467 9.45415 80.391 9.07146C81.3354 8.68877 82.3473 8.50114 83.3659 8.51983ZM79.3387 14.8282H87.3931C87.1398 13.9374 86.6031 13.1538 85.8645 12.5962C85.1258 12.0387 84.2256 11.7378 83.3006 11.7392C82.394 11.7504 81.5159 12.0584 80.8005 12.6162C80.0851 13.174 79.5717 13.9509 79.3387 14.8282Z" />
            </svg>
        </i>
        <i class="shopping-cart">
            <svg class="icon-shopping-cart" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
        </i>
    </div>
    <div id="header-container" v-else class="desktop-nav">
        <div class="header-left">
            <i class="logo-hismile">
                <svg class="hismile-logo" width="91" height="24" viewBox="0 0 91 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.50743 0V10.7635C4.01695 10.0459 4.6957 9.46562 5.48329 9.07415C6.27088 8.68267 7.1429 8.49217 8.02177 8.51958C11.4317 8.51958 13.9326 10.9583 13.9326 14.2426V23.576H10.4248V15.2181C10.3903 14.3229 10.0108 13.476 9.36609 12.8549C8.72136 12.2338 7.86144 11.8868 6.96675 11.8868C6.07206 11.8868 5.21214 12.2338 4.56741 12.8549C3.92268 13.476 3.54324 14.3229 3.50872 15.2181V23.5751H0V0H3.50743Z" fill="black"/>
                    <path d="M18.8034 2.04859C19.0998 2.0409 19.3947 2.09368 19.67 2.20373C19.9454 2.31377 20.1955 2.47878 20.4052 2.68869C20.6148 2.89861 20.7796 3.14904 20.8895 3.42476C20.9995 3.70047 21.0522 3.99569 21.0445 4.29246C21.0487 4.58679 20.9934 4.87892 20.8819 5.15127C20.7703 5.42362 20.6049 5.67054 20.3955 5.87714C20.1861 6.08375 19.9371 6.24577 19.6635 6.35345C19.3898 6.46112 19.0973 6.51221 18.8034 6.50365C18.5114 6.51135 18.2208 6.4594 17.9495 6.35099C17.6781 6.24258 17.4317 6.07996 17.2252 5.87306C17.0187 5.66616 16.8564 5.41931 16.7483 5.14756C16.6402 4.87582 16.5884 4.58487 16.5963 4.29246C16.585 3.99764 16.6342 3.70363 16.7406 3.42854C16.8471 3.15344 17.0087 2.90308 17.2155 2.69287C17.4222 2.48267 17.6698 2.31706 17.9429 2.20626C18.216 2.09545 18.5088 2.04179 18.8034 2.04859ZM20.5574 8.94236V23.5751H17.0499V8.94236H20.5574Z" fill="black"/>
                    <path d="M22.8955 19.7054L26.1753 19.2176C26.433 20.2258 27.3781 20.9411 29.0658 20.9411C30.3648 20.9411 31.404 20.4533 31.404 19.5428C31.404 18.9251 30.9495 18.5023 29.7802 18.1122L26.7926 17.169C24.3242 16.3561 23.2851 15.1531 23.2851 13.0718C23.2851 9.85287 25.8196 8.51953 28.9361 8.51953C32.151 8.51953 34.1648 10.0804 34.5205 12.4542L31.2403 13.0069C31.0131 12.1613 30.169 11.5445 28.6749 11.5445C27.5705 11.5445 26.6289 11.9673 26.6289 12.8129C26.6289 13.3656 27.0185 13.6907 27.9279 14.0172L30.916 15.0253C33.6115 15.9681 34.7482 17.3015 34.7482 19.415C34.7482 22.569 32.1497 24 28.967 24C25.396 24 23.2851 22.3071 22.8955 19.7054Z" fill="black"/>
                    <path d="M40.6597 8.94241V10.5033C41.142 9.87029 41.7671 9.36058 42.4838 9.01581C43.2006 8.67104 43.9886 8.50101 44.7836 8.51961C45.6917 8.50347 46.5895 8.71509 47.3951 9.13517C48.2006 9.55526 48.8885 10.1705 49.3959 10.9248C49.8952 10.155 50.5858 9.5284 51.4 9.10651C52.2142 8.68462 53.1239 8.48193 54.0399 8.51832C57.385 8.51832 59.8533 10.8594 59.8533 13.9489V23.5751H56.3781V14.9579C56.3829 14.5535 56.3074 14.1521 56.1562 13.777C56.0049 13.402 55.7808 13.0607 55.4969 12.773C55.2129 12.4853 54.8748 12.2569 54.502 12.101C54.1292 11.9451 53.7293 11.8649 53.3253 11.8649C52.9214 11.8649 52.5214 11.9451 52.1487 12.101C51.7759 12.2569 51.4378 12.4853 51.1538 12.773C50.8699 13.0607 50.6458 13.402 50.4945 13.777C50.3432 14.1521 50.2678 14.5535 50.2726 14.9579V23.5751H46.7652V14.9579C46.77 14.5535 46.6945 14.1521 46.5433 13.777C46.392 13.402 46.1679 13.0607 45.884 12.773C45.6 12.4853 45.2619 12.2569 44.8891 12.101C44.5164 11.9451 44.1164 11.8649 43.7124 11.8649C43.3085 11.8649 42.9085 11.9451 42.5358 12.101C42.163 12.2569 41.8249 12.4853 41.5409 12.773C41.257 13.0607 41.0329 13.402 40.8816 13.777C40.7303 14.1521 40.6549 14.5535 40.6597 14.9579V23.5751H37.1519V8.94241H40.6597Z" fill="black"/>
                    <path d="M64.7248 2.04857C65.0211 2.04095 65.3159 2.09378 65.5913 2.20385C65.8666 2.31392 66.1167 2.47893 66.3263 2.68884C66.5359 2.89875 66.7006 3.14916 66.8105 3.42485C66.9204 3.70053 66.9731 3.99572 66.9654 4.29245C66.9697 4.58674 66.9143 4.87884 66.8028 5.15116C66.6913 5.42347 66.5259 5.67037 66.3166 5.87697C66.1072 6.08358 65.8582 6.24561 65.5847 6.35331C65.3111 6.461 65.0186 6.51214 64.7248 6.50364C64.4327 6.51146 64.1421 6.4596 63.8706 6.35124C63.5992 6.24287 63.3527 6.08027 63.1461 5.87335C62.9395 5.66643 62.7772 5.41953 62.6691 5.14773C62.561 4.87592 62.5093 4.58491 62.5172 4.29245C62.5059 3.99758 62.555 3.7035 62.6615 3.42835C62.7679 3.15319 62.9296 2.90279 63.1364 2.69256C63.3432 2.48234 63.5909 2.31674 63.864 2.20599C64.1372 2.09523 64.4301 2.04166 64.7248 2.04857ZM66.4783 8.94235V23.5751H62.9708V8.94235H66.4783Z" fill="black"/>
                    <path d="M69.5962 0H73.1036V23.5751H69.5962V0Z" fill="black"/>
                    <path d="M83.3659 8.51983C84.3797 8.50779 85.3855 8.70046 86.3232 9.08633C87.261 9.4722 88.1114 10.0434 88.8238 10.7657C89.5361 11.488 90.0958 12.3467 90.4693 13.2904C90.8428 14.2341 91.0225 15.2435 90.9976 16.2583C90.9976 16.6937 90.9651 17.1284 90.9005 17.559H79.3061C79.559 18.4978 80.1186 19.3248 80.8956 19.9082C81.6725 20.4916 82.6222 20.7977 83.5932 20.7779C84.2406 20.7809 84.8809 20.6429 85.4697 20.3733C86.0585 20.1038 86.5818 19.7093 87.0031 19.217L90.4134 20.2252C89.7091 21.3997 88.7074 22.367 87.5098 23.0294C86.3122 23.6917 84.9611 24.0256 83.5932 23.9973C79.0788 23.9973 75.6689 20.6807 75.6689 16.2583C75.646 15.2385 75.8293 14.2246 76.2076 13.2775C76.5859 12.3304 77.1515 11.4696 77.8704 10.7468C78.5893 10.024 79.4467 9.45415 80.391 9.07146C81.3354 8.68877 82.3473 8.50114 83.3659 8.51983ZM79.3387 14.8282H87.3931C87.1398 13.9374 86.6031 13.1538 85.8645 12.5962C85.1258 12.0387 84.2256 11.7378 83.3006 11.7392C82.394 11.7504 81.5159 12.0584 80.8005 12.6162C80.0851 13.174 79.5717 13.9509 79.3387 14.8282Z" fill="black"/>
                </svg>
            </i>
            <a href="#" class="header-link">Shop the Kit</a>
            <a href="#" class="header-link">Explore the range</a>
        </div>
        
        <i class="shopping-cart">
                <span class="cart-text">My cart</span>
        </i>
    </div>
       
</div>
    `

}


const home_app = new Vue({
    name: 'Home App',
    el: '#body-container',
    delimiters: ['${', '}'],
    components: {
        "cover-video": CoverVideo,
        "header-nav": HeaderNav,
    },
    data: {
       screen_width: Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0),
    },
    mounted(){
        var debounce_screen_width = this.debounce(this.on_resize, 500)
        window.addEventListener("resize", debounce_screen_width);

      
       
    },
    methods: {
        on_resize: function on_resize(){
            this.screen_width = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
            console.log('resize')
        },
        debounce: function debounce(func, wait, immediate){
            var timeout;
            return function() {
                var context = this, args = arguments;
                var later = function() {
                    timeout = null;
                    if (!immediate) func.apply(context, args);
                };
                var callNow = immediate && !timeout;
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
                if (callNow) func.apply(context, args);
            };
        },
    },
    created() {
       
    }
})


window.onload = function () {
    lax.init()

    lax.addDriver('scrollY', function () {
      return window.scrollY
    }, { inertiaEnabled: true })

    lax.addElements(".waves", {
      scrollY: {
        scaleY: [
          ['elCenterY-50', 'elCenterY', 'elCenterY+50'],
          {
              991: [1, 1, 0],
              1200: [1, 0.5, 0],

          }
        ],

      },
    })
    lax.addElements(".kit_accent", {
      scrollY: {
        rotate: [
          ['elInY', 'elCenterY', 'elOutY+100'],
          [-90, 0, 0],
          {
              inertia: .1
          },
          {
              easing: 'easeInOutQuad',
          },
        ],
        opacity: [
        ['elInY', 'elCenterY', 'elOutY-100'],
          [0, 1, .5],
          {
              easing: 'easeInOutQuad',
          },
        ],
      },
    })
    lax.addElements(".kit_image", {
      scrollY: {
        rotate: [
          ['elInY', 'elCenterY', 'elOutY+100'],
          [20, 0, 0],
          {
              inertia: .1
          },
          {
              easing: 'easeInOutQuad',
          },
        ],
        opacity: [
        ['elInY', 'elCenterY', 'elOutY-100'],
          [0, 1, .5],
          {
              easing: 'easeInOutQuad',
          },
        ],
      },
    })
    lax.addElements("#header-outside-container", {}, {
        onUpdate: function (driverValues, domElement) {
          const scrollY = driverValues.scrollY[0]

          if (scrollY > 100) {
            domElement.classList.remove('transparent_nav')
          } else {
            domElement.classList.add('transparent_nav')
          }
        }
      })
  }

